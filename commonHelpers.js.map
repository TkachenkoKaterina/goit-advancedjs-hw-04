{"version":3,"file":"commonHelpers.js","sources":["../src/api.js","../src/index.js"],"sourcesContent":["import axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '32131085-77c33ae4af62fbdfe36accafe';\n\nasync function servicePixabay(searchQuery, page) {\n  return await axios.get(\n    `${BASE_URL}?key=${API_KEY}&q=${searchQuery}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=40`\n  );\n}\n\nexport { servicePixabay };\n","import iziToast from 'izitoast';\nimport '../node_modules/izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { servicePixabay } from '/api';\n\nconst elements = {\n  form: document.querySelector('#search-form'),\n  btnSearch: document.querySelector('button[type = submit]'),\n  gallery: document.querySelector('.gallery'),\n  btnLoadMore: document.querySelector('.load-more'),\n};\n\nelements.form.addEventListener('submit', onSubmit);\nelements.btnLoadMore.addEventListener('click', onLoadMore);\nelements.btnLoadMore.style.display = 'none';\n\nlet page = 1;\nconst per_page = 40;\n\nconst gallery = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\n// onLoadMore\nasync function onLoadMore() {\n  page += 1;\n  const searchQuery = elements.form.elements.searchQuery.value;\n\n  try {\n    const { data } = await servicePixabay(searchQuery, page);\n    elements.gallery.insertAdjacentHTML('beforeend', createGallery(data.hits));\n    let currentTotalPages = data.totalHits - per_page * (page - 1);\n\n    if (currentTotalPages > per_page) {\n      let totalPages = currentTotalPages / per_page;\n      iziToast.info({\n        title: 'Go-onðŸ¤©',\n        message: `${Math.ceil(totalPages)} pages left`,\n        position: 'topRight',\n        timeout: 5000,\n        closeOnClick: true,\n      });\n    } else if (currentTotalPages <= per_page) {\n      elements.btnLoadMore.style.display = 'none';\n      console.log('This is the last page of Gallery');\n      iziToast.warning({\n        title: 'Coool ðŸ˜¸',\n        message: 'This is the last page of Gallery',\n        position: 'topRight',\n        timeout: 5000,\n        closeOnClick: true,\n      });\n    }\n\n    gallery.refresh();\n\n    const { height: cardHeight } =\n      elements.gallery.firstElementChild.getBoundingClientRect();\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n  } catch (error) {\n    console.log(error);\n    console.log(error.message);\n  }\n}\n\n// onSubmit\nasync function onSubmit(event) {\n  event.preventDefault();\n  elements.gallery.innerHTML = '';\n\n  page = 1;\n  const formData = new FormData(event.currentTarget);\n  const searchQuery = formData.get('searchQuery').trim();\n\n  try {\n    const { data } = await servicePixabay(searchQuery, page);\n\n    if (data.totalHits === 0) {\n      elements.btnLoadMore.style.display = 'none';\n\n      iziToast.error({\n        title: 'Ooooops',\n        message:\n          'Sorry, there are no images matching your search query. Please try again.',\n        position: 'topRight',\n        timeout: 5000,\n        closeOnClick: true,\n      });\n    } else if (data.totalHits > per_page) {\n      elements.gallery.insertAdjacentHTML(\n        'beforeend',\n        createGallery(data.hits)\n      );\n\n      let totalPages = data.totalHits / per_page;\n\n      iziToast.info({\n        title: 'Go-onðŸ¤©',\n        message: `Hooray! We found ${data.totalHits} images (${Math.ceil(\n          totalPages\n        )} pages)`,\n        position: 'topRight',\n        timeout: 5000,\n        closeOnClick: true,\n      });\n\n      elements.btnLoadMore.style.display = 'block';\n    } else if (data.totalHits < per_page) {\n      elements.gallery.insertAdjacentHTML(\n        'beforeend',\n        createGallery(data.hits)\n      );\n\n      iziToast.warning({\n        title: 'Cool ðŸ˜¸',\n        message: 'This is the last page of Gallery',\n        position: 'topRight',\n        timeout: 5000,\n        closeOnClick: true,\n      });\n\n      elements.btnLoadMore.style.display = 'none';\n    }\n\n    gallery.refresh();\n\n    const { height: cardHeight } =\n      elements.gallery.firstElementChild.getBoundingClientRect();\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n  } catch (error) {\n    console.log(error);\n    console.log(error.message);\n  }\n}\n\n// createGallery\nfunction createGallery(arr) {\n  return arr\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `<div class=\"photo-card\">\n        <a href=\"${largeImageURL}\">\n          <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\"/>\n        </a>\n        <div class=\"info\">\n          <p class=\"info-item\">\n            <b>Likes: ${likes}</b>\n          </p>\n          <p class=\"info-item\">\n            <b>Views: ${views}</b>\n          </p>\n          <p class=\"info-item\">\n            <b>Comments: ${comments}</b>\n          </p>\n          <p class=\"info-item\">\n            <b>Downloads: ${downloads}</b>\n          </p>\n        </div>\n      </div>\n    `\n    )\n    .join('');\n}\n"],"names":["BASE_URL","API_KEY","servicePixabay","searchQuery","page","axios","elements","onSubmit","onLoadMore","per_page","gallery","SimpleLightbox","data","createGallery","currentTotalPages","totalPages","iziToast","cardHeight","error","event","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads"],"mappings":"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"}