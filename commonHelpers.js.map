{"version":3,"file":"commonHelpers.js","sources":["../src/index.js"],"sourcesContent":["import Notiflix from 'notiflix';\nimport '../node_modules/notiflix/dist/notiflix-3.2.6.min.css';\nimport axios from 'axios';\n\nconst elements = {\n  form: document.querySelector('#search-form'),\n  btnSearch: document.querySelector('button[type = submit]'),\n  gallery: document.querySelector('.gallery'),\n  btnLoadMore: document.querySelector('.load-more'),\n};\n\nconst BASE_URL = 'https://pixabay.com/api';\nconst API_KEY = '32131085-77c33ae4af62fbdfe36accafe';\n\nelements.btnLoadMore.style.display = 'none';\nlet page = 1;\n\nelements.form.addEventListener('submit', onSubmit);\nelements.btnLoadMore.addEventListener('click', onLoadMore);\n\nasync function onLoadMore() {\n  const searchQuery = elements.form.elements.searchQuery.value;\n  page += 1;\n  console.log(searchQuery);\n\n  try {\n    const response = await servicePixabay({ searchQuery });\n    console.log(response);\n\n    if (response.data.totalHits === 0) {\n      notifyUser(\n        'Sorry, there are no images matching your search query. Please try again.'\n      );\n      return;\n    }\n\n    elements.gallery.insertAdjacentHTML(\n      'beforeend',\n      renderGallery(response.data.hits)\n    );\n  } catch (error) {\n    console.error('Error loading more data:', error);\n  }\n}\n\nasync function onSubmit(event) {\n  event.preventDefault();\n  elements.gallery.innerHTML = '';\n  const data = {};\n  const formData = new FormData(event.currentTarget);\n  const searchQuery = formData.get('searchQuery');\n  await servicePixabay({ searchQuery });\n}\n\nasync function servicePixabay({ searchQuery }) {\n  try {\n    const params = new URLSearchParams({\n      key: API_KEY,\n      q: searchQuery,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page,\n      per_page: 40,\n    });\n\n    const response = await axios.get(`${BASE_URL}?${params}`);\n    console.log(response);\n    console.log(response.data);\n    console.log(response.data.hits);\n\n    if (response.data.totalHits === 0) {\n      console.log(\n        'Sorry, there are no images matching your search query. Please try again.'\n      );\n      return;\n    } else if (response.data.totalHits > 40) {\n      elements.btnLoadMore.style.display = 'block';\n      elements.gallery.insertAdjacentHTML(\n        'beforeend',\n        renderGallery(response.data.hits)\n      );\n    } else if (response.data.totalHits <= 40) {\n      elements.btnLoadMore.style.display = 'none';\n      elements.gallery.insertAdjacentHTML(\n        'beforeend',\n        renderGallery(response.data.hits)\n      );\n      console.log('This is the last page');\n    }\n  } catch (error) {\n    console.error('Error fetching data:', error);\n    console.log('Error details:', error.response);\n  } finally {\n  }\n}\n\nfunction renderGallery(arr) {\n  return arr\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `<div class=\"photo-card\">\n        <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" width=\"150\"/>\n        <div class=\"info\">\n            <p class=\"info-item\">\n            <b>Likes: ${likes}</b>\n            </p>\n            <p class=\"info-item\">\n            <b>Views: ${views}</b>\n            </p>\n            <p class=\"info-item\">\n            <b>Comments: ${comments}</b>\n            </p>\n            <p class=\"info-item\">\n            <b>Downloads: ${downloads}</b>\n            </p>\n        </div>\n    </div>\n    `\n    )\n    .join('');\n}\n"],"names":["elements","BASE_URL","API_KEY","page","onSubmit","onLoadMore","searchQuery","response","servicePixabay","renderGallery","error","event","params","axios","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads"],"mappings":"svBAIA,MAAMA,EAAW,CACf,KAAM,SAAS,cAAc,cAAc,EAC3C,UAAW,SAAS,cAAc,uBAAuB,EACzD,QAAS,SAAS,cAAc,UAAU,EAC1C,YAAa,SAAS,cAAc,YAAY,CAClD,EAEMC,EAAW,0BACXC,EAAU,qCAEhBF,EAAS,YAAY,MAAM,QAAU,OACrC,IAAIG,EAAO,EAEXH,EAAS,KAAK,iBAAiB,SAAUI,CAAQ,EACjDJ,EAAS,YAAY,iBAAiB,QAASK,CAAU,EAEzD,eAAeA,GAAa,CAC1B,MAAMC,EAAcN,EAAS,KAAK,SAAS,YAAY,MACvDG,GAAQ,EACR,QAAQ,IAAIG,CAAW,EAEvB,GAAI,CACF,MAAMC,EAAW,MAAMC,EAAe,CAAE,YAAAF,CAAa,CAAA,EAGrD,GAFA,QAAQ,IAAIC,CAAQ,EAEhBA,EAAS,KAAK,YAAc,EAAG,CACjC,WACE,0EACR,EACM,MACD,CAEDP,EAAS,QAAQ,mBACf,YACAS,EAAcF,EAAS,KAAK,IAAI,CACtC,CACG,OAAQG,EAAP,CACA,QAAQ,MAAM,2BAA4BA,CAAK,CAChD,CACH,CAEA,eAAeN,EAASO,EAAO,CAC7BA,EAAM,eAAc,EACpBX,EAAS,QAAQ,UAAY,GAG7B,MAAMM,EADW,IAAI,SAASK,EAAM,aAAa,EACpB,IAAI,aAAa,EAC9C,MAAMH,EAAe,CAAE,YAAAF,CAAW,CAAE,CACtC,CAEA,eAAeE,EAAe,CAAE,YAAAF,GAAe,CAC7C,GAAI,CACF,MAAMM,EAAS,IAAI,gBAAgB,CACjC,IAAKV,EACL,EAAGI,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAAH,EACA,SAAU,EAChB,CAAK,EAEKI,EAAW,MAAMM,EAAM,IAAI,GAAGZ,KAAYW,GAAQ,EAKxD,GAJA,QAAQ,IAAIL,CAAQ,EACpB,QAAQ,IAAIA,EAAS,IAAI,EACzB,QAAQ,IAAIA,EAAS,KAAK,IAAI,EAE1BA,EAAS,KAAK,YAAc,EAAG,CACjC,QAAQ,IACN,0EACR,EACM,MACD,MAAUA,EAAS,KAAK,UAAY,IACnCP,EAAS,YAAY,MAAM,QAAU,QACrCA,EAAS,QAAQ,mBACf,YACAS,EAAcF,EAAS,KAAK,IAAI,CACxC,GACeA,EAAS,KAAK,WAAa,KACpCP,EAAS,YAAY,MAAM,QAAU,OACrCA,EAAS,QAAQ,mBACf,YACAS,EAAcF,EAAS,KAAK,IAAI,CACxC,EACM,QAAQ,IAAI,uBAAuB,EAEtC,OAAQG,EAAP,CACA,QAAQ,MAAM,uBAAwBA,CAAK,EAC3C,QAAQ,IAAI,iBAAkBA,EAAM,QAAQ,CAChD,QAAY,CACT,CACH,CAEA,SAASD,EAAcK,EAAK,CAC1B,OAAOA,EACJ,IACC,CAAC,CACC,aAAAC,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IAAY;AAAA,oBACQN,WAAsBE;AAAA;AAAA;AAAA,wBAGlBC;AAAA;AAAA;AAAA,wBAGAC;AAAA;AAAA;AAAA,2BAGGC;AAAA;AAAA;AAAA,4BAGCC;AAAA;AAAA;AAAA;AAAA,KAKvB,EACA,KAAK,EAAE,CACZ"}